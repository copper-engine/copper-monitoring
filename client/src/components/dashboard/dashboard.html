<div class="dashboard">    
    <sidebar ref="drawer"></sidebar>
    <v-toolbar app fixed clipped-left class="toolbar">
        <v-toolbar-side-icon @click.stop="$refs.drawer.drawer = !$refs.drawer.drawer"></v-toolbar-side-icon>
        <v-toolbar-title>Copper Monitoring</v-toolbar-title>
        <v-spacer></v-spacer>
        <v-menu v-model="menuOpen" offset-y class="user-menu" :close-on-content-click="false">
            <v-btn @click="menuOpen = !menuOpen" slot="activator">  <v-icon>mdi-account</v-icon> User: {{ user.name }} </v-btn>
            <v-card class="user-menu-card">
                <v-layout column class="card-content">
                    <div class="user" v-if="!!user">
                        User Settings:
                    </div>
                    <v-layout row class="input-container">
                        <v-flex class="input-label">
                            Get data every 'x' seconds
                        </v-flex>
                        <v-flex class="input">
                            <v-text-field
                            v-on:change="setUpdate()"
                            v-on:keyup.enter="setUpdate()"
                            v-model="update"
                            mask="###"
                            ></v-text-field>
                        </v-flex>
                    </v-layout>
                    <v-layout row class="input-container">
                        <v-flex class="input-label">
                            <!-- Used for fetching data from engine -->
                            Not older than 'y' minutes
                        </v-flex>
                        <v-flex class="input">
                            <v-text-field
                            v-on:change="setFetch()"
                            v-on:keyup.enter="setFetch()"
                            v-model="fetch"
                            mask="###"
                            ></v-text-field>
                        </v-flex>
                    </v-layout>
                    <v-layout row class="switch-container">
                        <v-flex class="switch-label">
                            Dark Theme
                        </v-flex>
                        <v-switch v-model="themeSwitch"></v-switch>
                    </v-layout>
                </v-layout>
                <v-card-actions>
                    <v-btn @click="dialogConfig" v-if="!!user">
                        <v-icon>mdi-database</v-icon>
                        InfluxDB
                    </v-btn>
                    <v-btn @click="logout" v-if="!!user">
                        <v-icon>mdi-logout</v-icon>
                        Logout
                    </v-btn>
                </v-card-actions>
            </v-card>
        </v-menu>
    </v-toolbar>

    <!-- {{ connectionSettings }} -->

    <v-content>
        <v-container fluid fill-height>
            <!-- <h2>Dashboard </h2> -->
            <transition name="router-component" mode="out-in">
                <router-view>loading...</router-view>
            </transition>
        </v-container>
    </v-content>

    <v-footer :fixed="true" app>
        <v-spacer></v-spacer>
        <span>SCOOP Software &copy; 2018</span>
    </v-footer>

    <v-dialog v-model="dialogConfigOpen" scrollable max-width="1200px" position="absolute">
        <v-card>
            <v-card-title position="absolute" class="dialog-title">
                <h2>Generated Telegraf Configuration File</h2>
                <v-spacer></v-spacer>             
                    <v-btn depressed class="squareButton" @click="dialogConfigOpen = false"><v-icon>mdi-close</v-icon></v-btn>      
            </v-card-title>
            <v-divider></v-divider>
                <scroll class="scroll-area" :settings="{suppressScrollX: true, maxScrollbarLength: 400, wheelSpeed: 1}">
                    <v-card-text class="config-text">
                        <v-layout column class="telegraf-container">
                            <v-flex class="about">
                                <p>The following Configuration is for use with Telegram and InfluxDB. 
                                    The Input section of a Telegraf Configuration file has been generated to fetch data from all current
                                    connections and engines. Copy the Configuration, or download it with the button below. For more 
                                    information, visit <a href='https://www.influxdata.com/'>InfluxDB</a>
                                </p>
                            </v-flex>
                            <h1 v-if="(conflictText !== '')" class="conflict-text">Warning! You have at least 2 engines with the same mbean name, this can lead to inaccurate statistics</h1>
                            <scroll v-if="(conflictText !== '')" class="bean-warning telegraf-scroll-area" :settings="{suppressScrollX: true, maxScrollbarLength: 400, wheelSpeed: 0.7}">
                                <v-flex class="config">
                                        <p style="white-space: pre;">{{ conflictText }}</p>
                                </v-flex>
                            </scroll>
                            <h1>Input Configuration</h1>
                            <scroll class="telegraf-scroll-area" :settings="{suppressScrollX: true, maxScrollbarLength: 400, wheelSpeed: 0.7}">
                                <v-flex class="config">
                                    <div class="config-btn btn-container">
                                        <v-btn depressed @click="copy(configText)">Copy</v-btn>
                                        <v-btn depressed @click="downloadConfig">Download</v-btn>
                                    </div>
                                    <p style="white-space: pre;">{{ configText }}</p> 
                                </v-flex>
                            </scroll>
                            <h1>Sample Queries</h1>
                            <scroll class="telegraf-scroll-area" :settings="{suppressScrollX: true, maxScrollbarLength: 400, wheelSpeed: 0.2}">
                                <v-flex class="config">
                                        <div class="query-btn btn-container">
                                            <v-btn depressed @click="copy(queryText)">Copy</v-btn>
                                        </div>
                                        <p style="white-space: pre;">{{ queryText }}</p>  
                                </v-flex>
                            </scroll>
                        </v-layout>
                    </v-card-text>
                </scroll>
            <v-divider></v-divider>
        </v-card>
    </v-dialog>

</div>